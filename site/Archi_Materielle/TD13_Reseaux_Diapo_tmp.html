<!DOCTYPE html>
<html>
<head>
<title>TD13_Reseaux_Diapo.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<style>
    :root {
    --color-background: #101010 !important;
	--color-foreground: #FFFFFF !important;
     font-size: 1.25rem;
    }
blockquote {
  background: #C3B091;
  border-left: 15px solid #CC0000;
  margin: 1.5em 10px;
  color: black;
  padding: 0.5em 10px;
}
</style>
<h1 id="td-n%C2%B013--architecture-dun-r%C3%A9seau">TD n°13 : Architecture d'un réseau</h1>
<h2 id="programme-officiel">Programme officiel</h2>
<p><img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/BO.png" alt="image"></p>
<p>Ce cours a pour but de présenter la constitution classique d'un réseau, et les équipements associés. La partie relative aux protocoles utilisés lors des échanges entre deux machines est détaillée dans un cours ultérieur sur les protocoles de communication.</p>
<hr>
<h1 id="i-d%C3%A9couverte-de-filius">I. Découverte de Filius</h1>
<blockquote>
<p><a href="https://www.lernsoftware-filius.de/Herunterladen">lien</a> de téléchargement de Filius.</p>
</blockquote>
<p><img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/filius_documentation.png" alt="w:700"></p>
<hr>
<p>Il existe deux modes d’utilisation.</p>
<ul>
<li>Pour réaliser le circuit, on utilise le mode conception en cliquant sur l’icône <img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/conception.png" alt="w:50">. Les éléments disponibles sont disposés sur le bord vertical gauche de la fenêtre et il suffit de les glisser/déposer dans la zone centrale de conception.</li>
<li>Pour effectuer une simulation et installer des logiciels sur les éléments du réseau, on utilise le mode simulation en cliquant sur l’icône <img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/simulation.png" alt="w:50">.</li>
</ul>
<p>Pour visualiser correctement le trajet des données sur le réseau, il faut régler la vitesse sur une petite valeur : 10 % ou 20 %.</p>
<hr>
<h1 id="ii-connexion-pair-%C3%A0-pair-de-deux-machines">II. Connexion pair à pair de deux machines</h1>
<p>L’objectif de cette partie est de relier en réseau deux machines. Une telle connexion est dite pair à pair.<br>
Créer un nouveau projet Filius et l’enregistrer dans un dossier de son espace personnel sous le mon de TD13_exercice1.fls.</p>
<hr>
<ol>
<li>Passer en mode conception et créer un réseau de deux machines hôtes de type portable reliées par un câble.</li>
<li>Faire un clic droit sur une machine et lui attribuer l’adresse IP 192.168.1.1 comme ci-dessous, en sélectionnant l’option Utiliser l’adresse IP comme nom.  Attribuer de même l’adresse IP 192.168.1.2 à l’autre machine.</li>
<li>Passer en mode simulation, faire un clic droit sur la machine 192.168.1.1, sélectionner Afficher le bureau et installer l’application ligne de commandes en la faisant glisser vers la zone des applications installées à gauche comme ci-dessous.
<img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/pair_a_pair.png" alt="w:450"></li>
</ol>
<hr>
<p><img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/filius_appli.png" alt="w:500">
4. Lancer l’application ligne de commandes sur la machine 192.168.1.1 puis exécuter la commande ipconfig.
Repérer les divers informations données.
5. Dans l’application ligne de commandes sur la machine 192.168.1.1 exécuter la commande ping 192.168.1.2 pour tester la connexion vers la machine ping 192.168.1.2.</p>
<hr>
<p>Le cable devrait se colorer en vert si la connexion est correcte et les quatre paquets de données envoyés par ping devraient recevoir un écho pong retourné par ping 192.168.1.2.</p>
<p><img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/ping.png" alt="image"></p>
<hr>
<blockquote>
<p>Ce qu’il faut retenir
- <strong>ipconfig</strong> sous Windows permet de connaître son adresse IP locale et son adresse MAC
- <strong>ping</strong> qui permet d’envoyer des paquets de données d’une machine A vers une machine B.<br>
Si la commande est exécutée sur la machine A, le <strong>ping</strong> devra être suivi par l’adresse IP de la machine B (par exemple, si l’adresse IP de B est &quot;192.168.1.1&quot;, on aura &quot;ping 192.168.1.2&quot;)</p>
</blockquote>
<hr>
<h1 id="iii-premier-r%C3%A9seau-local">III. Premier réseau local</h1>
<p>Créer le réseau local ci-dessous :</p>
<p><img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/f1.png" alt=""></p>
<p>Pour interconnecter plus de deux machines on utilise un <code>commutateur ou switch</code> en Anglais.<br>
Créer un switch relié aux trois machines.</p>
<hr>
<blockquote>
<p>&quot;Switch&quot;
Un switch ressemble à une multiprise avec plusieurs ports Ethernet RJ45 auxquels sont reliés les machines du réseau local. Il établit une table de correspondances entre adresse physique MAC et ports.<br>
Lorsqu’il reçoit un paquet, il lit l’adresse MAC du destinataire et transmet le paquet sur le port correspondant.</p>
</blockquote>
<hr>
<p>Tester le <code>ping</code> de la machine <code>192.168.0.1</code>  vers la machine <code>192.168.0.3</code>.</p>
<p><strong>Résultat du ping</strong></p>
<p><img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/ft1.png" alt="w:750"></p>
<hr>
<h2 id="iii1-la-carte-r%C3%A9seau-et-son-adresse-mac">III.1. La carte réseau et son adresse MAC</h2>
<p>Chaque ordinateur sur le réseau dispose d'une adresse MAC, qui une valeur <strong>unique</strong> attribuée à sa carte réseau (Ethernet, Wifi, 4G, 5G, ...) lors de sa fabrication en usine.</p>
<p>Cette adresse est codée sur 48 bits, présentés sous la forme de 6 octets en hexadécimal. Exemple : <code>fc:aa:14:75:45:a5</code></p>
<p>Les trois premiers octets correspondent au code du fabricant.<br>
Un site comme https://www.macvendorlookup.com/ vous permet de retrouver le fabricant d'une adresse MAC quelconque.</p>
<blockquote>
<p><strong>Ce qu’il faut retenir</strong>
Toutes les interfaces réseau possèdent une <strong>adresse physique MAC</strong> qui est *<em>unique</em> et attribuée par le constructeur. Elle est constituée sur 48 bits ou 6 octets représentés en notation hexadécimale et séparés par le caractère : (colon en anglais).<br>
L’adresse MAC est nécessaire pour la liaison réseau entre deux équipements tandis que l’adresse IP est nécessaire pour le routage sur Internet.</p>
</blockquote>
<hr>
<h2 id="iii2-switch-hub-quelle-diff%C3%A9rence">III.2. Switch, hub, quelle différence ?</h2>
<ul>
<li>Au sein d'un <strong>hub Ethernet</strong> (de moins en moins vendus), il n'y a <strong>aucune analyse</strong> des données qui transitent : il s'agit simplement d'un dédoublement des fils de cuivre (tout comme une multiprise électrique). L'intégralité des messages est donc envoyée à l'intégralité des ordinateurs du réseau, même s'ils ne sont pas concernés.</li>
</ul>
<p><img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/hub.png" alt=""></p>
<hr>
<ul>
<li>Au sein d'un <strong>switch Ethernet</strong> , une analyse est effectuée sur la trame qui est à distribuer. Lors d'un branchement d'un nouvel ordinateur sur le switch, celui-ci récupère son adresse MAC, ce qui lui permet de <strong>trier</strong> les messages et de ne les distribuer qu'au bon destinataire.</li>
</ul>
<p><img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/switch.png" alt=""></p>
<hr>
<h1 id="iv-un-deuxi%C3%A8me-sous-r%C3%A9seau">IV. Un deuxième sous-réseau</h1>
<p>Rajouter un deuxième sous-réseau de la manière suivante (penser à bien renommer les switchs).</p>
<p><img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/f2.png" alt=""></p>
<hr>
<p><strong>Comment relier ces deux sous-réseaux ?</strong></p>
<p>Une réponse pas si bête : avec un cable entre les deux switchs !</p>
<p><img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/f3.png" alt=""></p>
<p>Tester cette hypothèse en essayant de pinger la machine <code>192.168.1.2</code> depuis la machine <code>192.168.0.1</code>.</p>
<hr>
<p><strong>Résultat du ping</strong></p>
<p><img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/ft2.png" alt="w:750">
Cela ne marche pas. L'ordinateur <strong>refuse</strong> d'envoyer le ping vers la machine <code>192.168.1.2</code>.<br>
<em>(spoil : car elle n'est pas dans son sous-réseau)</em></p>
<hr>
<p>Temporairement, renommons la machine <code>192.168.1.2</code> en <code>192.168.0.33</code>. Testons à nouveau le ping depuis la machine <code>192.168.0.1</code>.</p>
<p><strong>Résultat du ping</strong></p>
<p><img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/ft3.png" alt="w:750">
Cela marche. Les paquets sont bien acheminés.</p>
<blockquote>
<p><strong>Intuition</strong> : la notion de sous-réseau n'est pas <em>topologique</em> («il suffit de relier les ordinateurs entre eux») mais obéit à des règles numériques.</p>
</blockquote>
<hr>
<h2 id="iii21-notion-de-masque-de-sous-r%C3%A9seau">III.2.1. Notion de masque de sous-réseau</h2>
<p>Dans Filius, lors de l'attribution de l'adresse IP à une machine, une ligne nous permet de spécifier le <strong>masque de sous-réseau</strong> (appelé simplement « Masque » dans Filius). C'est ce masque qui va permettre de déterminer si une machine appartient à un sous-réseau ou non, en fonction de son adresse IP.</p>
<p><img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/f4.png" alt=""></p>
<hr>
<h3 id="iii211-explication-basique">III.2.1.1 Explication basique</h3>
<ul>
<li>Si le masque est <code>255.255.255.0</code>, toutes les machines partageant les mêmes <strong>trois</strong> premiers nombres de leur adresse IP appartiendront au même sous-réseau. Comme ceci est le réglage par défaut de Filius, cela explique pourquoi  <code>192.168.0.33</code> et <code>192.168.0.1</code> sont sur le même sous-réseau, et pourquoi  <code>192.168.1.2</code> et <code>192.168.0.1</code> ne sont pas sur le même sous-réseau.</li>
</ul>
<p>Dans cette configuration, 256 machines peuvent donc appartenir au même sous-réseau (ce n'est pas tout à fait le cas car des adresses finissant par 0 ou par 255 sont réservées).</p>
<hr>
<ul>
<li>Si le masque est <code>255.255.0.0</code>, toutes les machines partageant les mêmes <strong>deux</strong> premiers nombres de leur adresse IP appartiendront au même sous-réseau.<br>
Dans cette configuration, 65536 machines peuvent être dans le même sous-réseau. (car $256^2=65536$)</li>
</ul>
<p><strong>Exercice</strong></p>
<ul>
<li>Renommons <code>192.168.0.33</code> en <code>192.168.1.2</code> et modifions son masque en <code>255.255.0.0</code>.</li>
<li>Modifions aussi le masque de <code>192.168.0.1</code> en <code>255.255.0.0</code>.</li>
<li>Testons le ping de <code>192.168.0.1</code> vers <code>192.168.1.2</code>.</li>
</ul>
<hr>
<p><strong>Résultat du ping</strong>
<img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/ft4.png" alt="w:750">
Cela marche. Les deux machines appartiennent maintenant au même sous-réseau.</p>
<hr>
<h3 id="iii212-explication-avanc%C3%A9e">III.2.1.2 Explication avancée</h3>
<p>Lorsqu'une machine A veut envoyer un message à une machine B, elle doit déterminer si cette machine :</p>
<ul>
<li>appartient au même sous-réseau : auquel cas le message est envoyé directement via un ou plusieurs switchs.</li>
<li>n'appartient pas au même sous-réseau : auquel cas le message doit d'abord transiter par un routeur (voir V.)</li>
</ul>
<hr>
<p>Quelle opération permet de distinguer cette appartenance à un même sous-réseau ?</p>
<p>Appelons <code>IP_A</code> et <code>IP_B</code> les adresses IP respectives des machines A et B.<br>
Appelons <code>M</code> le masque de sous-réseau.<br>
Nommons <code>&amp;</code> l'opérateur de conjonction entre nombres binaires :</p>
<table>
<thead>
<tr>
<th>E1</th>
<th>E2</th>
<th>E1 &amp; E2</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
<hr>
<blockquote>
<p><strong>Propriété :</strong><br>
A et B appartiennent au même sous-réseau ⇔ <code>IP_A &amp; M = IP_B &amp; M</code></p>
</blockquote>
<p><strong>Exemple :</strong> considérons trois machines A, B, C d'IP respectives <code>192.168.129.10</code>, <code>192.168.135.200</code> et <code>192.168.145.1</code>, configurées avec un masque de sous-réseau égal à <code>255.255.248.0</code>.</p>
<table>
<thead>
<tr>
<th></th>
<th>machine A</th>
<th>machine B</th>
<th>machine C</th>
</tr>
</thead>
<tbody>
<tr>
<td>IP</td>
<td>192.168.129.10</td>
<td>192.168.135.200</td>
<td>192.168.145.1</td>
</tr>
<tr>
<td>M</td>
<td>255.255.248.0</td>
<td>255.255.248.0</td>
<td>255.255.248.0</td>
</tr>
<tr>
<td>Adresse réseau :IP &amp; M</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Vérifions si ces trois machines sont sur le même réseau.</p>
<hr>
<blockquote>
<p><strong>Règles de calcul :</strong>
- pour tout octet <code>x</code>, <code>x &amp; 255 = x</code>  et <code>x &amp; 0 = 0</code>.
- <code>129 &amp; 248</code> s'écrit en binaire <code>10000001 &amp; 11111000</code> qui vaut <code>10000000</code>, soit <code>128</code> en décimal.</p>
</blockquote>
<p><strong>Exercice :</strong>
Faite de même pour les machines A et C</p>
<hr>
<p><strong>Conclusion :</strong><br>
les machines A et B sont sous le même sous-réseau, mais pas la machine C.</p>
<hr>
<h3 id="213-coh%C3%A9rence-entre-les-deux-explications">2.1.3 Cohérence entre les deux explications</h3>
<p>Lorsqu'un masque de sous-réseau est égal à <code>255.255.255.0</code>, l'opération de conjonction <code>&amp;</code> avec chaque IP ne laissera intacts que les 3 premiers octets, le dernier sera égal à 0.<br>
Donc si deux adresses s'écrivent <code>A.B.C.X</code> et   <code>A.B.C.Y</code>, elles appartiendront forcément au même sous-réseau (typiquement, c'est le cas de <code>192.168.0.33</code> et <code>192.168.0.1</code>).</p>
<hr>
<h2 id="22-%C3%A9criture-des-masques-de-sous-r%C3%A9seau--notation-cidr">2.2 Écriture des masques de sous-réseau : notation CIDR</h2>
<p>D'après ce qui précède, 2 informations sont nécessaires pour déterminer le sous-réseau auquel appartient une machine : son IP et le masque de sous-réseau.</p>
<p>Une convention de notation permet d'écrire simplement ces deux renseignements : <strong>la notation CIDR</strong>.</p>
<hr>
<p><strong>Exemple</strong> :</p>
<ul>
<li>Une machine d'IP <code>192.168.0.33</code> avec un masque de sous-réseau <code>255.255.255.0</code> sera désignée par <code>192.168.0.33 / 24</code> en notation CIDR.</li>
<li>Le suffixe <code>/ 24</code> signifie que le masque de sous-réseau commence par  24 bits consécutifs de valeur 1 : le reste des bits (donc 8 bits) est à mis à 0.</li>
<li>Autrement dit, ce masque vaut <code>11111111.11111111.11111111.00000000</code> , soit <code>255.255.255.0</code>.</li>
</ul>
<p>De la même manière, le suffixe <code>/ 16</code> donnera un masque de <code>11111111.11111111.00000000.00000000</code> , soit <code>255.255.0.0</code>.<br>
Ou encore, un suffixe <code>/ 21</code> donnera un masque de <code>11111111.11111111.11111000.00000000</code> , soit <code>255.255.248.0</code>.</p>
<hr>
<h1 id="v-un-vrai-r%C3%A9seau-contenant-deux-sous-r%C3%A9seaux-distincts--la-n%C3%A9cessit%C3%A9-dun-routeur">V. Un vrai réseau contenant deux sous-réseaux distincts : la nécessité d'un routeur</h1>
<p>Notre solution initiale (relier les deux switchs par un cable pour unifier les deux sous-réseaux) n'est pas viable à l'échelle d'un réseau planétaire.</p>
<p>Pour que les machines de deux réseaux différents puissent être connectées, on va utiliser un dispositif équipé de <strong>deux cartes réseaux</strong>, situé à cheval entre les deux sous-réseaux. Cet équipement de réseau est appelé <strong>routeur</strong> ou <strong>passerelle</strong>.</p>
<p><img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/routeur.png" alt=""></p>
<hr>
<h2 id="v1-principe-de-fonctionnement">V.1 Principe de fonctionnement</h2>
<p>Imaginons que la machine <code>192.168.0.1 / 24</code> veuille communiquer avec la machine  <code>172.16.52.3 / 24</code>.<br>
L'observation du masque de sous-réseau de la machine <code>192.168.0.1 / 24</code> nous apprend qu'elle ne peut communiquer qu'avec les adresses de la forme <code>192.168.0.X / 24</code>, où <code>X</code> est un nombre entre 0 et 255.</p>
<hr>
<p>Les 3 étapes du <strong>routage</strong> :</p>
<ul>
<li>Lorsque qu'une machine A veut envoyer un message à une machine B, elle va tout d'abord vérifier si cette machine appartient à son réseau local. si c'est le cas, le message est envoyé par l'intermédiaire du switch qui relie les deux machines.</li>
<li>Si la machine B n'est pas trouvée sur le réseau local de la machine A, le message va être acheminé vers le routeur, par l'intermédiaire de son adresse de passerelle (qui est bien une adresse appartenant au sous-réseau de A).</li>
<li>De là, le routeur va regarder si la machine B appartient au deuxième sous-réseau auquel il est connecté. Si c'est le cas, le message est distribué, sinon, le routeur va donner le message à un autre routeur auquel il est connecté et va le charger de distribuer ce message : c'est le procédé de <a href="https://openclassrooms.com/fr/courses/857447-apprenez-le-fonctionnement-des-reseaux-tcp-ip/854659-le-routage">routage</a>, qui sera vu en classe de Terminale.</li>
</ul>
<hr>
<p>Dans notre exemple, l'adresse <code>172.16.52.3</code> n'est pas dans le sous-réseau de <code>192.168.0.1</code>. Le message va donc transiter par le routeur.<br>
<img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/routeur2.png" alt=""></p>
<hr>
<h2 id="v2-illustration-avec-filius">V.2 Illustration avec Filius</h2>
<ul>
<li>
<p>Rajoutons un routeur entre le SwitchA et le SwitchB.
<img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/f5.png" alt=""></p>
</li>
<li>
<p><strong>Configuration du routeur :</strong><br>
L'interface reliée au Switch A doit avoir une adresse du sous-réseau A. On donne souvent une adresse finissant par <code>254</code>, qui est en quelque sorte la dernière adresse du réseau (en effet l'adresse en <code>255</code> est appelée adresse de <strong>broadcast</strong>, utilisée pour pinger en une seule fois l'intégralité d'un sous-réseau).</p>
</li>
</ul>
<hr>
<p>On donne donc l'adresse <code>192.168.0.254</code> pour l'interface reliée au Switch A, et <code>192.168.1.254</code> pour l'interface reliée au Switch B.<br>
<img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/flsrouteur.png" alt="">
Dans l'onglet général, sélectionner « Routage automatique ».<br>
Ainsi configuré notre routeur peut jouer le rôle de <strong>passerelle</strong> entre les deux sous-réseaux.</p>
<p>Test du ping entre <code>192.168.0.1</code> et <code>192.168.1.2</code></p>
<p><img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/ft2.png" alt="w:750">
Cela ne marche pas. Les paquets sont perdus.</p>
<hr>
<p>Pourquoi cet échec ? Parce que nous devons dire à chaque machine qu'une passerelle est maintenant disponible pour pouvoir sortir de son propre sous-réseau. Il faut donc aller sur la machine <code>192.168.0.1</code> et lui donner l'adresse de sa passerelle, qui est <code>192.168.0.254</code>.</p>
<p><img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/passerelle.png" alt=""></p>
<hr>
<p>Attention, il faut faire de même pour <code>192.168.1.2</code> (avec la bonne passerelle...)<br>
Testons à nouveau le ping... Cette fois cela marche.</p>
<p>Plus intéressant : effectuons un <code>traceroute</code> entre  <code>192.168.0.1</code> et <code>192.168.1.2</code>.</p>
<p><img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/traceroute.png" alt="w:750"></p>
<p>On y aperçoit que la machine <code>192.168.1.2</code> est atteignable en deux sauts depuis <code>192.168.0.1</code>, en passant par la passerelle <code>192.168.0.254</code></p>
<hr>
<p><strong>Cas d'un réseau domestique</strong></p>
<p>Chez vous, la box de votre opérateur joue simultanément le rôle de switch et de routeur :</p>
<ul>
<li>switch car elle répartit la connexion entre les différents dispositifs (ordinateurs branchés en ethernet, smartphone en wifi, tv connectée...)</li>
<li>routeur car elle fait le lien entre ce sous-réseau domestique (les appareils de votre maison) et le réseau internet.</li>
</ul>
<p><img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/boxmaison.png" alt=""></p>
<hr>
<p>L'image ci-dessous présente le résultat de la commande <code>ipconfig</code> sous Windows. On y retrouve l'adresse IP locale <code>192.168.9.103</code>, le masque de sous-réseau <code>255.255.255.0</code> et l'adresse de la passerelle <code>192.168.9.1</code>.<br>
<img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/imgpasserelle.jpg" alt=""></p>
<hr>
<h2 id="33-annexe--rajout-dun-serveur-dns">3.3 Annexe : rajout d'un serveur DNS</h2>
<h3 id="331-rajout-dun-serveur-web">3.3.1 Rajout d'un serveur web</h3>
<ul>
<li>Connectons un ordinateur au SwitchB, sur l'adresse <code>192.168.1.30</code> et installons dessus un Serveur web et démarrons-le.
<img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/serveurweb.png" alt=""></li>
</ul>
<hr>
<ul>
<li>Sur la machine <code>192.168.0.1</code>, rajoutons un Navigateur Web. En tapant dans la barre d'adresse l'adresse IP du Serveur web, la page d'accueil de Filius s'affiche.<br>
<img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/nav1.png" alt=""></li>
</ul>
<hr>
<p>Lors d'une utilisation classique d'un navigateur web, c'est une url mémorisable qui s'affiche, et non une adresse IP : on retient en effet plus facilement <code>https://www.google.com/</code> que <code>http://216.58.213.131</code>, qui renvoient pourtant à la même adresse.
La machine qui assure ce rôle d'annuaire entre les serveurs web et leur adresse IP s'appelle un <strong>serveur DNS</strong>. Pour pouvoir indexer la totalité des sites internet, son rôle est structuré de manière hiérarchique. Vous trouverez des détails <a href="https://openclassrooms.com/fr/courses/857447-apprenez-le-fonctionnement-des-reseaux-tcp-ip/857163-le-service-dns">ici</a></p>
<hr>
<h3 id="v31-rajout-dun-serveur-dns">V.3.1 Rajout d'un serveur DNS</h3>
<ul>
<li>Rajoutons un serveur DNS minimal, qui n'aura dans son annuaire d'un seul site. Il faut pour cela raccorder une nouvelle machine (mais une machine déjà sur le réseau aurait très bien pu jouer ce rôle), et installer dessus un serveur DNS.<br>
<img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/dns.png" alt=""></li>
</ul>
<hr>
<ul>
<li>Sur ce serveur DNS, associons l'adresse <code>http://www.vivelansi.fr</code>  à l'adresse IP <code>192.168.1.30</code>.<br>
<img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/vivelansi.png" alt=""></li>
</ul>
<hr>
<ul>
<li>De retour sur notre machine <code>192.168.0.1</code>, spécifions maintenant l'adresse du serveur DNS :<br>
<img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/specdns.png" alt=""></li>
</ul>
<hr>
<ul>
<li>Depuis le navigateur web de la machine <code>192.168.0.1</code>, le site <code>http://www.vivelansi.fr</code> est maintenant accessible.<br>
<img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/dnsex.png" alt=""></li>
</ul>
<hr>
<h1 id="vi-routage-dans-une-interconnexion-de-r%C3%A9seaux">VI. Routage dans une interconnexion de réseaux</h1>
<p>Récupérer le fichier <a href="https://drive.google.com/file/d/1HM1gD5_AR9lvYEI3FY2ppTncDGyEXP3E/view?usp=sharing">exercice_ressources.fls</a> puis l’ouvrir avec Filius.</p>
<p><img src="file:///media/michael/TRAVAIL/2.NSI/siteGithub/siteNSI1ere/docs/Archi_Materielle/data/Exo_routeur.png" alt="w:650"></p>
<hr>
<ol>
<li>Récupérer les adresses IP des machines M14 et M9.</li>
<li>En mode simulation, faire un ping de la machine M14 vers M9 pour vérifier la connexion.<br>
Faire un traceroute de la machine M14 vers M9 . Noter le chemin parcouru pour aller de M14 vers M9 .</li>
<li>Supprimer le câble réseau (clic droit sur le câble) qui relie le routeur F au routeur E (simulation de panne) et refaire un traceroute de M14 et M9.<br>
Attendre un peu pour que les tables de routage des routeurs se mettent à jour.<br>
Que constate-t-on ?</li>
</ol>
<hr>
<br>
<hr>
<p><strong>Bibliographie</strong></p>
<ul>
<li>Cours d'OpenClassrooms :
<ul>
<li>https://openclassrooms.com/fr/courses/857447-apprenez-le-fonctionnement-des-reseaux-tcp-ip/854659-le-routage</li>
<li>https://openclassrooms.com/fr/courses/1561696-les-reseaux-de-zero/3607286-ladressage-cidr</li>
</ul>
</li>
</ul>
<hr>

</body>
</html>
